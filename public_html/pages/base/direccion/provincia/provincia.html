<section class="content">
    <div class="row">
        <section class="content-header">
            <div class="h3">
                <i class="fa fa-map-marker"></i>
                Provincias
            </div>
            <div class="breadcrumb">
                <button permission-hide="['ACTION_LOG_LIST']" uib-tooltip="Ver acciones" tooltip-append-to-body="true" ui-sref="actionLog/class ({clazz:'Provincia'})" class="btn bg-olive" > 
                    <span class="hidden-xs">Ver acciones</span> <i class="fa fa-list-ol"></i>
                </button>
                <button type="button" class="btn btn-default" back-button="">
                    <i class="fa fa-arrow-left"></i>
                    Atras
                </button>
            </div>
        </section>
    </div>
    <div class="row">
        <div class="col-md-6"><div class="callout callout-default">
                <div class="box box-primary"> 
                    <div class="box-body">
                        <form ng-submit="!provinciaSel.id ? create() : update()" name="provincia">
                            <div class="form-group">
                                <label class="control-label"><cr/>Países</label>                 
                            <ui-select  ng-model="paisSel" theme="bootstrap"  close-on-select="true" on-select="changeTableProvince(paisSel.id)">
                                    <ui-select-match placeholder="Seleccionar país" allow-clear="true" >{{$select.selected.nombre}} </ui-select-match> 
                                    <ui-select-choices repeat=" item in paises |orderBy:'nombre'| filter:$select.search">
                                        <div ng-bind-html="item.nombre | highlight: $select.search"></div>
                                    </ui-select-choices>
                                    <ui-select-no-choice>
                                        No se ha encontrado el país
                                    </ui-select-no-choice>
                                </ui-select>
                            </div>
                            <div class="form-group">
                                <label class="control-label"><cr/>Nombre</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" name="nombre" required="" ng-model="provinciaSel.nombre" ng-maxlength="{{validations.nombre.maxlength}}" maxlength="{{validations.nombre.maxlength}}">
                                    <span class="input-group-addon"><i class="fa fa-font"></i></span>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div ng-show="provincia.nombre.$error.maxlength" class="alert no-padding alert-warning">
                                    <i class="fa fa-warning"></i>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    Logitud maxima: {{validations.nombre.maxlength}}
                                </div>
                            </div>

                            <div class="btn-group">
                                <button class="btn btn-default" c-class-hover="dark-green" ng-class="{'c-highlight-default': !provinciaSel.id}" ng-disabled="provinciaSel.id">
                                    <i class="fa fa-plus-circle"></i> Agregar
                                </button>
                                <button class="btn btn-default "  c-class-hover="dark-green" ng-class="{'c-highlight-default': provinciaSel.id}" ng-disabled="!provinciaSel.id">
                                    <i class="fa fa-edit"></i> Modificar
                                </button>                
                                <span permission-hide="[ 'PROVINCIA_REM']" >
                                    <button c-btnremove="provinciaSel" c-service="ProvinciaServ" c-name="{{provinciaSel.nombre}}"  c-callback="onAction"
                                            class="btn btn-default" type="button"  c-class-hover="red" ng-disabled="!provinciaSel.id"  >
                                <i ng-class="!provinciaSel.deletedAt ? 'fa fa-trash-o': 'fa fa-check-circle blue'"></i> <span ng-if="!provinciaSel.deletedAt"> Eliminar</span><span ng-if="provinciaSel.deletedAt"> Restaurar</span>
                                    </button>
                                </span>
                                <button class="btn btn-default" type="button" ng-click="onClear()">
                                    <i class="fa fa-eraser"></i> Limpiar campos
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="box box-primary"> 
                <div class="box-body" st-table="provinciasTbl"  st-safe-src="provincias">
                    <span class="pull-left"> 
                        <select class="form-control input-sm" ng-model="jconfFiltro.op" ng-change="init()">
                            <option value="NOT_FILTER">Todos</option>
                            <option value="NULL">Normal</option>
                            <option value="NOT_NULL">Eliminados</option>
                        </select> 
                    </span>
                    <span class="pull-right">
                        <i class="fa fa-filter"></i>
                        <input type="text" ng-model="filtro.$" placeholder="Filtro">
                    </span>

                    <table class="table table-hover table-striped table-condensed" >
                        <thead>
                            <tr>
                                <th>País</th>
                                <th>Provincia</th>
                                <th style="width: 80px"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="l in provinciasTbl| filter:filtro" ng-click="onSelect(l)" ng-class="{'st-selected':l.id === provinciaSel.id}">
                                <td>{{l.paisNombre}}</td>
                                <td>{{l.nombre}}</td>
                                <td>  
                                    <a  permission-hide="['PROVINCIA_REM']" >
                                        <c-btnremoveview c-obj="l"
                                                         c-service="ProvinciaServ"
                                                         c-name="{{l.nombre}}"
                                                         c-callback="onAction">
                                        </c-btnremoveview> 
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-center">
                                    <div st-pagination="" st-items-by-page="10" st-displayed-pages="7"></div>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

            </div>
        </div>


    </div>
</section>

